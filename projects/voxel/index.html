<!doctype html>
<html>
<head>
    <title>Voxel Space project demonstration</title>
    <link type="text/css" rel="stylesheet" href="./webroot/css/style.css">
</head>
<body scroll="no">
    <div id="fps">0.0 fps</div>

    <div id="info">
        <h1>Controls</h1>
        <div class="control"><label>Move</label>WASD/click</div>
        <div class="control"><label>Up/down</label>R/F</div>
        <div class="control"><label>Pitch</label>Q/E</div>
        <br/>
        <h4>Fade algorithm</h4>
        <select name="FadeSelector" size="1" onchange="changeFade(this.value)">
            <option value="none">None</option>
            <option value="linear">Linear</option>
            <option value="linear_delayed" selected>Linear delayed</option>
            <option value="exponential">Exponential</option>
        </select>
        
        <h4>Render distance</h4>
        <input id="distancerange" type="range" min="100" max="5000" step="1" onchange="changeCameraDistance(this.value)" value="3000" />
        
        <h4>Level of detail</h4>
        <input type="range" min="0" max="10" step="0.005" onchange="changeLOD(this.value)" value="7.75" />

        <h4>Resolution</h4>
        <input id="lodrange" type="range" min="0.25" max="1" step="0.00005" onchange="changeResolution(this.value)" value="0.5" />

        <h4>Map selector</h4>
        <select id="map" name="Mapselector" size="1" onchange="loadMap(this.value);">
            <option value="C1W;D1">Map C1W</option>
            <option value="generate;rainbow">Generate rainbow</option>
            <option selected value="generate;landscape">Generate landscape</option>
        </select>
        <button onclick="loadMap(document.getElementById('map').value)">Reload</button>

        <h4>Goxel text file</h4>
        <input id="file" name="file" type="file" onchange="upload()" />
        <button onclick="download()">Download</button>
    </div>

    <canvas id="canvas">
        Your browser does not support the canvas element.
    </canvas>

    <script type='text/javascript' src="webroot/js/renderer.js"></script>
    <script type='text/javascript' src="webroot/js/generator.js"></script>
    <script type='text/javascript' src="webroot/js/bindings.js"></script>
    <script type='text/javascript'>
        function init() {    
            
            onResize();
            
            // set event handlers for keyboard, mouse, touchscreen and window resize
            window.onkeydown = onKeyDown;
            window.onkeyup   = onKeyUp;
            window.onresize  = onResize;
            CANVAS_ELEM.onmousedown  = onMouseDown;
            CANVAS_ELEM.onmousemove  = onMouseMove;
            CANVAS_ELEM.onmouseup    = onMouseUp;
            CANVAS_ELEM.ontouchstart = onMouseDown;
            CANVAS_ELEM.ontouchmove  = onMouseMove;
            CANVAS_ELEM.ontouchend   = onMouseUp;
            CANVAS_ELEM.style.setProperty("background", BACKGROUND_COLOR);
            
            window.setInterval(function(){
                const current = new Date().getTime();
                document.getElementById('fps').innerText = (frameCount / (current-timelastframe) * 1000).toFixed(1) + " fps";
                frameCount = 0;
                timelastframe = current;
            }, 2000);
            draw();
        }

        init();
        
        loadMap("generate;landscape");
    </script>
</body>
</html>